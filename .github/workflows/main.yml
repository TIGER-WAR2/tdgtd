name: Run Facebook Auto-Reply Bot

on:
  workflow_dispatch:  # ম্যানুয়ালি ট্রিগার করার জন্য
  schedule:
    - cron: '0 */6 * * *'  # প্রতি ৬ ঘন্টা পরপর রান করবে

jobs:
  run-bot:
    runs-on: ubuntu-latest
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Setup Node.js
      uses: actions/setup-node@v4
      with:
        node-version: '18.x'

    - name: Install dependencies
      run: npm install

    - name: Create id.js file
      run: |
        cat <<EOT > id.js
        module.exports = {
          appState: ${{ secrets.FB_COOKIES }}
        };
        EOT

    - name: Create .env file
      run: |
        echo "OPENAI_API_KEY=${{ secrets.OPENAI_API_KEY }}" > .env

    - name: Run the bot
      run: node bot.js
      env:
        NODE_ENV: production
